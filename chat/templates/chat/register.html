{% extends 'chat/base.html' %}
{% block title %}Register{% endblock %}
{% block navbar %}{% endblock %}

{% block content %}
<style>
  body {
    background: linear-gradient(135deg, #4f46e5, #3b82f6);
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  }

  .register-card {
    min-width: 420px;
    max-width: 480px;
    background: #fff;
    padding: 2rem 2.5rem;
    border-radius: 1rem;
    box-shadow: 0 8px 25px rgba(0,0,0,0.15);
    animation: fadeIn 0.7s ease-in-out;
  }

  h2 {
    font-weight: 700;
    color: #1e293b;
  }

  .form-label {
    font-weight: 600;
    color: #475569;
  }

  input, select, textarea {
    width: 100%;
    padding: 0.55rem 0.85rem;
    margin-top: 0.25rem;
    margin-bottom: 0.5rem;
    border: 1px solid #ccc;
    border-radius: 0.375rem;
    font-size: 1rem;
    transition: border-color 0.3s ease;
  }

  input:focus, select:focus, textarea:focus {
    border-color: #4f46e5;
    outline: none;
    box-shadow: 0 0 8px rgba(79, 70, 229, 0.4);
  }

  .text-danger {
    font-size: 0.875rem;
    color: #dc3545;
    margin-top: -0.4rem;
    margin-bottom: 0.5rem;
  }

  .btn-success {
    background-color: #4f46e5;
    border: none;
    font-weight: 600;
    font-size: 1.125rem;
    transition: background-color 0.3s ease;
    padding: 0.65rem;
  }

  .btn-success:hover {
    background-color: #4338ca;
  }

  /* Password toggle checkbox hidden */
  input[type="checkbox"].togglePasswordCheckbox {
    display: none;
  }

  /* Show password when checkbox is checked */
  input[type="checkbox"].togglePasswordCheckbox:checked
    ~ input.passwordField {
    -webkit-text-security: none !important;
    text-security: none !important;
  }

  /* Default password hide with dots */
  input.passwordField {
    -webkit-text-security: disc;
    text-security: disc;
  }

  .toggle-password-label {
    user-select: none;
    font-size: 0.9rem;
    color: #475569;
    cursor: pointer;
    display: inline-flex;
    align-items: center;
    gap: 0.3rem;
  }

  @media (max-width: 576px) {
    .register-card {
      min-width: 90vw;
      padding: 1.2rem;
    }
  }

  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }
</style>

<div class="d-flex justify-content-center align-items-center vh-100">
  <div class="register-card">
    <h2 class="text-center mb-4">üìù Register</h2>
    <form method="post" novalidate>
      {% csrf_token %}

      {{ form.non_field_errors }}
      {% for field in form %}
        <div class="mb-3">
          <label for="{{ field.id_for_label }}" class="form-label">{{ field.label }}</label>

          {% if 'password' in field.name %}
            {# Password input with toggle #}
            <input
              type="password"
              name="{{ field.name }}"
              id="{{ field.id_for_label }}"
              class="form-control passwordField"
              placeholder="{{ field.label }}"
              required
              autocomplete="new-password"
            >
            <div class="form-text mt-1">
              <input type="checkbox" id="toggle_{{ field.name }}" class="togglePasswordCheckbox">
              <label for="toggle_{{ field.name }}" class="toggle-password-label">Show Password</label>
            </div>
          {% else %}
            {{ field }}
          {% endif %}

          {% if field.errors %}
            <div class="text-danger small">{{ field.errors.0 }}</div>
          {% endif %}
        </div>
      {% endfor %}

      <button type="submit" class="btn btn-success w-100">Register</button>
    </form>

    <p class="text-center mt-3 mb-0 text-white">
      Already registered? <a href="{% url 'login' %}" class="text-decoration-underline text-white">Login here</a>
    </p>
  </div>
</div>
{% endblock %}
